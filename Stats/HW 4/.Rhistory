---
title: "Homework 4 Submission"
rm(list = ls(all=TRUE))
graphics.off()
shell("cls")
knitr::opts_chunk$set(echo = TRUE)
```{r, include=FALSE}
library(readxl)
library(here)
library(epiR)
library(epiR)
library(MASS)
library(nnet)
library(car)
library(PairedData)
library(tidyverse)
library(ggplot2)
library(pwr)
library(FSA)
library(ggpubr)
library(rstatix)
library(datarium)
library(emmeans)
library(sjstats)
library(lme4)
library(lme4)
library(lmerTest)
library(MuMIn)
library(forcats)
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(pwr)
library(ggpubr)
library(rstatix)
library(datarium)
library(emmeans)
library(sjstats)
library(lme4)
library(lmerTest)
library(MuMIn)
library(dplyr)
library(forcats)
library(readxl)
library(tidyverse)
# Question 1
a. Evaluate the null hypothesis that the population proportions of students who drove while drinking are the same in the two calendar years (2010 and 2014).
> For this analysis, we can use the Chi-square test to compare the proportions of students who drove while drinking in both years.
```{r, out.width="60%",}
# Create the contingency table
data1 <- matrix(c(1250, 991, 1387, 1666), nrow = 2, byrow = TRUE)
data1
colnames(data1) <- c("2010", "2014")
rownames(data1) <- c("Yes", "No")
data1 <- as.table(data1)
data1
# Perform the Chi-square test
chi_square_test <- chisq.test(data1)
# Print the result
print(chi_square_test)
```{r, out.width="60%",}
# Create the contingency table
data2 <- matrix(c(1763, 489, 403, 670), nrow = 2, byrow = TRUE)
colnames(data2) <- c("Present", "Absent")
rownames(data2) <- c("Present", "Absent")
data2 <- as.table(data2)
data2
# Perform the Chi-square test
chi_square_test2 <- chisq.test(data2)
# Print the result
print(chi_square_test2)
# Import the dataset
alcohol <- read_excel("alchohol.xls")
# Import the dataset
alcohol <- read_excel("\alchohol.xls")
# Import the dataset
alcohol <- read_excel("\alchohol.xls")
library(readxl)
alcohol <- read_excel("alcohol.xls")
View(alcohol)
# Import the dataset
alcohol <- read_excel("\alchohol.xls")
# Load the necessary library
library(readxl)
# Import the dataset
alcohol <- read_excel("alchohol.xls")
# Import the dataset
alcohol <- read_excel("alcohol.xls")
# Load the necessary library
library(readxl)
# Import the dataset
alcohol_data <- read_excel("alcohol.xls")
# Create a contingency table
contingency_table <- table(alcohol_data$genques, alcohol_data$alcques)
# Perform the Chi-square test
chi_square_result <- chisq.test(contingency_table)
# Display the result
print(chi_square_result)
contingency_table
```
```
# Load the necessary library
library(readxl)
library(ggplot2)
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
# Create a scatter plot
ggplot(ischemic_data, aes(x = time, y = duration)) +
geom_point() +
labs(title = "Scatter Plot of Time to Angina vs Duration of Angina",
x = "Time to Angina (seconds)",
y = "Duration of Angina (seconds)")
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
library(readxl)
ischemic <- read_excel("ischemic.xls")
# Load the necessary library
library(readxl)
library(ggplot2)
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
# Load the necessary library
library(readxls)
library(ggplot2)
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
rm(list = ls(all=TRUE))
graphics.off()
shell("cls")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(here)
library(epiR)
library(MASS)
library(nnet)
library(car)
library(PairedData)
library(tidyverse)
library(ggplot2)
library(pwr)
library(FSA)
library(ggpubr)
library(rstatix)
library(datarium)
library(emmeans)
library(sjstats)
library(lme4)
library(lmerTest)
library(MuMIn)
library(forcats)
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(pwr)
library(ggpubr)
library(rstatix)
library(datarium)
library(emmeans)
library(sjstats)
library(lme4)
library(lmerTest)
library(MuMIn)
library(dplyr)
library(forcats)
# Create the contingency table
data1 <- matrix(c(1250, 991, 1387, 1666), nrow = 2, byrow = TRUE)
colnames(data1) <- c("2010", "2014")
rownames(data1) <- c("Yes", "No")
data1 <- as.table(data1)
# Perform the Chi-square test
chi_square_test <- chisq.test(data1)
# Print the result
print(chi_square_test)
# Create the contingency table
data2 <- matrix(c(1763, 489, 403, 670), nrow = 2, byrow = TRUE)
colnames(data2) <- c("Present", "Absent")
rownames(data2) <- c("Present", "Absent")
data2 <- as.table(data2)
# Perform the Chi-square test
chi_square_test2 <- chisq.test(data2)
# Print the result
print(chi_square_test2)
# Load the necessary library
library(readxl)
# Import the dataset
alcohol_data <- read_excel("alcohol.xls")
# Create a contingency table
contingency_table <- table(alcohol_data$genques, alcohol_data$alcques)
# Perform the Chi-square test
chi_square_result <- chisq.test(contingency_table)
# Display the result
print(chi_square_result)
# Load the necessary library
library(readxl)
library(ggplot2)
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
# Load the necessary library
library(readxl)
# Import the dataset
alcohol_data <- read_excel("alcohol.xls")
# Create a contingency table
contingency_table <- table(alcohol_data$genques, alcohol_data$alcques)
# Perform the Chi-square test
chi_square_result <- chisq.test(contingency_table)
# Display the result
print(chi_square_result)
```
> Based on the p-value from the Chi-square test result which is less than 0.05, we reject the null hypothesis and we can conclude there is a significant association between the two questionnaires.
# Question 4
a. Create a two-way scatter plot for these data.
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
# Load the necessary library
library(readxl)
library(ggplot2)
# Import the dataset
ischemic_data <- read_excel("ischemic(1).xls")
# Load the necessary library
library(readxl)
library(ggplot2)
# Import the dataset
ischemic_data <- read_excel("ischemic(1).xls")
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
# Create a scatter plot
ggplot(ischemic_data, aes(x = time, y = duration)) +
geom_point() +
labs(title = "Scatter Plot of Time to Angina vs Duration of Angina",
x = "Time to Angina (seconds)",
y = "Duration of Angina (seconds)")
# Perform hypothesis test for correlation
cor_test_result <- cor.test(ischemic$time, ischemic$duration)
> Based on the p-value from the Chi-square test result which is less than 0.05, we reject the null hypothesis and we can conclude there is a significant association between the two questionnaires.
# Import the dataset
ischemic_data <- read_excel("ischemic.xls")
# Create a scatter plot
ggplot(ischemic_data, aes(x = time, y = duration)) +
geom_point() +
labs(title = "Scatter Plot of Time to Angina vs Duration of Angina",
x = "Time to Angina (seconds)",
y = "Duration of Angina (seconds)")
# Create a scatter plot
ggplot(ischemic_data, aes(x = time, y = duration)) +
geom_point() +
labs(title = "Scatter Plot of Time to Angina vs Duration of Angina",
x = "Time to Angina (seconds)",
y = "Duration of Angina (seconds)")
# Create a scatter plot
ggplot(ischemic_data, aes(x = time, y = duration)) +
geom_point() +
labs(title = "Scatter Plot of Time to Angina vs Duration of Angina",
x = "Time to Angina (seconds)",
y = "Duration of Angina (seconds)")
```
> We can inspect the scatter plot for a linear trend. Since the points suggest a linear relationship, we can proceed with correlation analysis.
c. In calculating the correlation coefficient, which test will you use, Pearson or Spearman? Why?
> Since both variables are continuous and likely normally distributed, use Pearson's correlation. If not normally distributed, use Spearman.
d. Test the null hypothesis that the population correlation is equal to 0.
```{r, out.width="60%",}
```{r, out.width="60%",}
# Perform hypothesis test for correlation
cor_test_result <- cor.test(ischemic$time, ischemic$duration)
# Print results
cor_test_result
# Perform hypothesis test for correlation
cor_test_result <- cor.test(ischemic_data$time, ischemic_data$duration)
# Print results
cor_test_result
# Import dataset
lowbwt <- read_excel("lowbwt.xls")
```{r, out.width="60%",}
# Import dataset
lowbwt <- read_excel("lowbwt.xls")
# View the dataset
View(lowbwt)
# Conduct Spearman correlation
spearman_result <- cor.test(lowbwt$sbp, lowbwt$apgar5, method="spearman")
# Print results
spearman_result
# Import dataset
water <- read_excel("water.xls")
# View the dataset
View(water)
# Create scatter plot
plot(water$fluoride, water$caries,
main="Scatter Plot of Fluoride vs Dental Caries",
xlab="Fluoride Content (ppm)",
ylab="Number of Caries per 100 Children",
pch=19, col='green')
# Import dataset
water <- read_excel("water.xls")
# View the dataset
View(water)
# Create scatter plot
plot(water$fluoride, water$caries,
main="Scatter Plot of Fluoride vs Dental Caries",
xlab="Fluoride Content (ppm)",
ylab="Number of Caries per 100 Children",
pch=19, col='green')
# Create scatter plot
plot(water$fluoride, water$caries,
main="Scatter Plot of Fluoride vs Dental Caries",
xlab="Fluoride Content (ppm)",
ylab="Number of Caries per 100 Children",
pch=19, col='green')
## B.
# Calculate correlation
fluoride_caries_correlation <- cor(water$fluoride, water$caries)
fluoride_caries_correlation
## C.
# Conduct hypothesis test
correlation_test <- cor.test(water$fluoride, water$caries)
# Print results
correlation_test
# Import dataset
actions <- read_excel("actions.xls")
# Import dataset
actions <- read_excel("actions.xls")
# Import dataset
actions <- read_excel("actions.xls")
# Import dataset
actions <- read_excel("actions.xls")
# View the dataset
View(actions)
# Calculate correlations
correlation_1991_1992 <- cor(actions$rank91, actions$rank92)
correlation_1991_1993 <- cor(actions$rank91, actions$rank93)
correlation_1991_1994 <- cor(actions$rank91, actions$rank94)
correlation_1991_1995 <- cor(actions$rank91, actions$rank95)
# Print results
correlation_1991_1992
correlation_1991_1993
correlation_1991_1994
correlation_1991_1995
## B.
# Conduct hypothesis tests
test_1991_1992 <- cor.test(actions$rank91, actions$rank92)
## B.
# Conduct hypothesis tests
test_1991_1992 <- cor.test(actions$rank91, actions$rank92)
test_1991_1993 <- cor.test(actions$rank91, actions$rank93)
test_1991_1994 <- cor.test(actions$rank91, actions$rank94)
test_1991_1995 <- cor.test(actions$rank91, actions$rank95)
# Print results
test_1991_1992
test_1991_1993
test_1991_1994
# Print results
test_1991_1992
test_1991_1993
test_1991_1994
test_1991_1995
# Print results
correlation_1991_1992
correlation_1991_1993
correlation_1991_1994
correlation_1991_1995
