Arsenic <- read_excel("Arsenic.xlsx")
str(Arsenic)
view(Arsenic)
library(readxl)
Arsenic <- read_excel("Arsenic.xlsx")
str(Arsenic)
view(Arsenic)
view(Arsenic)
View(Arsenic)
>>>>>>> d70cc6c (ugh)
library(readxl)
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
View(IQ_Brain_Size)
knitr::opts_chunk$set(echo = TRUE)
```{r, out.width="60%"}
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
View(IQ_Brain_Size)
library(readxl)
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
data <- IQ_Brain_Size
library(ggplot2)
library(ggplot2)
# Plot scatterplot
ggplot(data, aes(x = VOL, y = IQ)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(title = "Scatterplot of IQ vs Brain Volume", x = "Brain Volume (VOL)", y = "IQ")
# Correlation test
cor_test <- cor.test(data$IQ, data$VOL)
# Print the correlation coefficient and p-value
cor_test
# Correlation test
cor_test <- cor.test(data$IQ, data$VOL)
# Print the correlation coefficient and p-value
cor_test
# Plot residuals and QQ plot to check assumptions
model <- lm(IQ ~ VOL, data = data)
residuals <- model$residuals
# Residual plot
ggplot(data, aes(x = VOL, y = residuals)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
labs(title = "Residuals vs Brain Volume", x = "Brain Volume (VOL)", y = "Residuals")
# QQ plot for normality of residuals
qqnorm(residuals)
qqline(residuals, col = "red")
# Model summary
summary(model)
library(readxl)
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
data <- IQ_Brain_Size
library(ggplot2)
# Assumption check: Scatter plot
ggplot(data, aes(x = IQ, y = VOL)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(title = "Scatterplot of IQ vs Brain Volume", x = "IQ", y = "Brain Volume (VOL)")
# Pearson correlation test
cor_test <- cor.test(data$IQ, data$VOL)
# Output correlation coefficient and p-value
cor_test
# Plot residuals for assumption check
model <- lm(VOL ~ IQ, data = data)
ggplot(data, aes(x = IQ, y = model$residuals)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(title = "Residual Plot", x = "IQ", y = "Residuals")
# Summary of the linear regression model (optional)
summary(model)
```{r, out.width="60%"}
library(readxl)
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
data <- IQ_Brain_Size
library(ggplot2)
# Assumption check: Scatter plot
ggplot(data, aes(x = IQ, y = VOL)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(title = "Scatterplot of IQ vs Brain Volume", x = "IQ", y = "Brain Volume (VOL)")
# Pearson correlation test
cor_test <- cor.test(data$IQ, data$VOL)
# Output correlation coefficient and p-value
cor_test
# Question 6
## Hypothesis
- Null Hypothesis (Ho): The mean arsenic levels in rice from Arkansas, California, and Texas are the same.
## Assumptions for One-way ANOVA
- Normality: The arsenic levels within each state should be normally distributed. We can use Q-Q plots or the Shapiro-Wilk test to check this.
Arsenic$STATE <- as.factor(Arsenic$STATE)
# 1. Check normality using Q-Q plot for each group
par(mfrow = c(1, 3))  # Set up plotting area
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "Arkansas"], main = "Arkansas")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "Arkansas"])
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "California"], main = "California")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "California"])
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "Texas"], main = "Texas")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "Texas"])
# 2. Perform Levene's test for homogeneity of variance
leveneTest(ARSENIC ~ STATE, data = Arsenic)
## clean R environment
rm(list = ls(all=TRUE))
graphics.off()
shell("cls")
knitr::opts_chunk$set(echo = TRUE)
# Include Libraries
library(readxl)
library(ggplot2)
library(here)
library(epiR)
library(MASS)
library(nnet)
library(car)
library(PairedData)
library(pwr)
library(dplyr)
library(FSA) #posthoc
# Blood pressure before taking the supplement
before <- c(130, 125, 140, 135, 138, 132, 137, 142, 129, 136, 133, 139, 140, 150)
# Blood pressure after taking the supplement for 8 weeks
after <- c(122, 118, 133, 127, 129, 124, 130, 135, 121, 128, 126, 132, 120, 123)
# Run a paired t-test
t_test_result <- t.test(after, before, paired = TRUE, alternative = "less")
# View the results
print(t_test_result)
# Data
before <- c(20, 22, 19, 5, 23, 21, 25, 22, 24, 10)
after <- c(15, 26, 21, 10, 27, 23, 60, 26, 27, 50)
# Differences
diff <- before - after
# Check normality of the differences (Shapiro-Wilk test)
shapiro.test(diff)
# Perform a paired t-test
t.test(before, after, paired = TRUE)
library(ggplot2)
library(dplyr)
library(readxl)
Births <- read_excel("Births.xlsx")
#View(Births)
# Convert GENDER to a factor
Births$`GENDER (1=M)` <- as.factor(Births$`GENDER (1=M)`)
levels(Births$`GENDER (1=M)`) <- c("0", "1")
# Check the structure of the data
str(Births)
# Visualize the birth weight distribution
ggplot(Births, aes(x = `GENDER (1=M)`, y = `BIRTH WEIGHT`, fill = 'GENDER (1=M)')) +
geom_boxplot() +
labs(title = "Birth Weight Distribution by Gender",
x = "Gender (1=M)",
y = "Birth Weight (g)") +
theme_minimal()
# Perform normality test for each group (Shapiro-Wilk Test)
shapiro.test(Births$`BIRTH WEIGHT`[Births$`GENDER (1=M)` == "0"])
shapiro.test(Births$`BIRTH WEIGHT`[Births$`GENDER (1=M)` == "1"])
# Since the data may not be normally distributed, use the Mann-Whitney U test
wilcox.test(`BIRTH WEIGHT` ~ `GENDER (1=M)`, data = Births, alternative = "two.sided")
# Display summary statistics
Births %>%
group_by(`GENDER (1=M)`) %>%
summarise(median_bw = median(`BIRTH WEIGHT`),
mean_bw = mean(`BIRTH WEIGHT`),
sd_bw = sd(`BIRTH WEIGHT`))
library(readxl)
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
data <- IQ_Brain_Size
library(ggplot2)
# Assumption check: Scatter plot
ggplot(data, aes(x = IQ, y = VOL)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(title = "Scatterplot of IQ vs Brain Volume", x = "IQ", y = "Brain Volume (VOL)")
# Pearson correlation test
cor_test <- cor.test(data$IQ, data$VOL)
# Output correlation coefficient and p-value
cor_test
# Plot residuals for assumption check
model <- lm(VOL ~ IQ, data = data)
ggplot(data, aes(x = IQ, y = model$residuals)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(title = "Residual Plot", x = "IQ", y = "Residuals")
# Summary of the linear regression model (optional)
summary(model)
# Original data
set.seed(123)
steps <- c(3200, 2900, 3100, 3000, 2800, 3500, 3100, 3000, 3300, 3400,
2800, 2900, 3200, 3000, 3100, 3300, 3400, 3600, 3500, 3400,
3000, 2900, 3100, 3200, 3100, 3000, 2800, 2900, 3200, 3100,
3000, 3200, 3300, 3400, 3500, 3600, 3400, 3300, 3200, 3100)
## Q.5.1
# Plotting histogram of original data
hist(steps, prob = TRUE, main = "Histogram of Original Step Data with Normal Density Curve", xlab = "Steps")
curve(dnorm(x, mean = mean(steps), sd = sd(steps)), add = TRUE, col = "blue", lwd = 2)
## Q.5.2
# Log transformation
log_steps <- log(steps)
# Plotting histogram of log-transformed data
hist(log_steps, prob = TRUE, main = "Histogram of Log-Transformed Step Data with Normal Density Curve", xlab = "Log(Steps)")
curve(dnorm(x, mean = mean(log_steps), sd = sd(log_steps)), add = TRUE, col = "blue", lwd = 2)
## Q.5.3
# Shapiro-Wilk test for original data
shapiro_original <- shapiro.test(steps)
# Shapiro-Wilk test for log-transformed data
shapiro_log <- shapiro.test(log_steps)
# Display results
shapiro_original
shapiro_log
library(readxl)
Arsenic <- read_excel("Arsenic.xlsx")
View(Arsenic)
Arsenic$STATE <- as.factor(Arsenic$STATE)
# Check assumptions
# 1. Check normality using Q-Q plot for each group
par(mfrow = c(1, 3))  # Set up plotting area
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "Arkansas"], main = "Arkansas")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "Arkansas"])
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "California"], main = "California")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "California"])
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "Texas"], main = "Texas")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "Texas"])
# 2. Perform Levene's test for homogeneity of variance
leveneTest(ARSENIC ~ STATE, data = Arsenic)
# Perform the one-way ANOVA
anova_result <- aov(ARSENIC ~ STATE, data = Arsenic)
# Summary of the ANOVA
summary(anova_result)
# If significant, conduct a post-hoc test to see which groups differ
TukeyHSD(anova_result)
# Visualize the group means
boxplot(ARSENIC ~ STATE, data = Arsenic, main = "Arsenic Levels by State",
xlab = "State", ylab = "Arsenic Levels", col = c("lightblue", "lightgreen", "lightcoral"))
# 1. Check normality using Q-Q plot for each group
par(mfrow = c(1, 3))  # Set up plotting area
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "Arkansas"], main = "Arkansas")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "Arkansas"])
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "California"], main = "California")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "California"])
qqnorm(Arsenic$ARSENIC[Arsenic$STATE == "Texas"], main = "Texas")
qqline(Arsenic$ARSENIC[Arsenic$STATE == "Texas"])
# 2. Perform Levene's test for homogeneity of variance
leveneTest(ARSENIC ~ STATE, data = Arsenic)
# Perform the one-way ANOVA
anova_result <- aov(ARSENIC ~ STATE, data = Arsenic)
# Summary of the ANOVA
summary(anova_result)
# If significant, conduct a post-hoc test to see which groups differ
TukeyHSD(anova_result)
# Visualize the group means
boxplot(ARSENIC ~ STATE, data = Arsenic, main = "Arsenic Levels by State",
xlab = "State", ylab = "Arsenic Levels", col = c("lightblue", "lightgreen", "lightcoral"))
# Visualize the group means
boxplot(ARSENIC ~ STATE, data = Arsenic, main = "Arsenic Levels by State",
xlab = "State", ylab = "Arsenic Levels", col = c("lightblue", "lightgreen", "lightcoral"))
# Visualize the group means
boxplot(ARSENIC ~ STATE, data = Arsenic, main = "Arsenic Levels by State",
xlab = "State", ylab = "Arsenic Levels", col = c("lightblue", "lightgreen", "lightcoral"))
```
library(readxl)
Arsenic <- read_excel("Arsenic.xlsx")
View(Arsenic)
# Question 6
## Hypothesis
- Null Hypothesis (Ho): The mean arsenic levels in rice from Arkansas, California, and Texas are the same.
## Assumptions for One-way ANOVA
- Normality: The arsenic levels within each state should be normally distributed. We can use Q-Q plots or the Shapiro-Wilk test to check this.
# Convert STATE to a factor
arsenic_data$STATE <- as.factor(arsenic_data$STATE)
```{r, out.width="60%"}
library(readxl)
arsenic_data <- read_excel("Arsenic.xlsx")
# Convert STATE to a factor
arsenic_data$STATE <- as.factor(arsenic_data$STATE)
# Check the structure of the data
str(arsenic_data)
# 2. Assumption Checks
# Check for homogeneity of variances using Levene's Test
leveneTest(ARSENIC ~ STATE, data = arsenic_data)
# Check for normality using QQ plots and Shapiro-Wilk test for each group
par(mfrow = c(1, 3))  # Set up a 1x3 plotting area
with(arsenic_data, {
qqnorm(ARSENIC[STATE == "Arkansas"], main = "Arkansas")
qqline(ARSENIC[STATE == "Arkansas"])
qqnorm(ARSENIC[STATE == "California"], main = "California")
qqline(ARSENIC[STATE == "California"])
qqnorm(ARSENIC[STATE == "Texas"], main = "Texas")
qqline(ARSENIC[STATE == "Texas"])
})
shapiro.test(arsenic_data$ARSENIC[arsenic_data$STATE == "Arkansas"])
shapiro.test(arsenic_data$ARSENIC[arsenic_data$STATE == "California"])
shapiro.test(arsenic_data$ARSENIC[arsenic_data$STATE == "Texas"])
# 3. Perform the one-way ANOVA
anova_model <- aov(ARSENIC ~ STATE, data = arsenic_data)
# Get the summary of the ANOVA (provides MS Between, MS Within, and F value)
summary(anova_model)
# 6. Interpretation of the p-value
p_value <- summary(anova_model)[[1]]["Pr(>F)"][1]
# 7. Conclusion based on the p-value
if (p_value < 0.05) {
cat("Reject Ho: The mean arsenic levels differ between states.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
cat("Fail to reject Ho: There is no significant difference in arsenic levels between states.\n")
}
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
## clean R environment
rm(list = ls(all=TRUE))
graphics.off()
shell("cls")
knitr::opts_chunk$set(echo = TRUE)
# Include Libraries
library(readxl)
library(ggplot2)
library(here)
library(epiR)
library(MASS)
library(nnet)
library(car)
library(PairedData)
library(pwr)
library(dplyr)
library(FSA) #posthoc
# Blood pressure before taking the supplement
before <- c(130, 125, 140, 135, 138, 132, 137, 142, 129, 136, 133, 139, 140, 150)
# Blood pressure after taking the supplement for 8 weeks
after <- c(122, 118, 133, 127, 129, 124, 130, 135, 121, 128, 126, 132, 120, 123)
# Run a paired t-test
t_test_result <- t.test(after, before, paired = TRUE, alternative = "less")
# View the results
print(t_test_result)
# Data
before <- c(20, 22, 19, 5, 23, 21, 25, 22, 24, 10)
after <- c(15, 26, 21, 10, 27, 23, 60, 26, 27, 50)
# Differences
diff <- before - after
# Check normality of the differences (Shapiro-Wilk test)
shapiro.test(diff)
# Perform a paired t-test
t.test(before, after, paired = TRUE)
library(ggplot2)
library(dplyr)
library(readxl)
Births <- read_excel("Births.xlsx")
#View(Births)
# Convert GENDER to a factor
Births$`GENDER (1=M)` <- as.factor(Births$`GENDER (1=M)`)
levels(Births$`GENDER (1=M)`) <- c("0", "1")
# Check the structure of the data
str(Births)
# Visualize the birth weight distribution
ggplot(Births, aes(x = `GENDER (1=M)`, y = `BIRTH WEIGHT`, fill = 'GENDER (1=M)')) +
geom_boxplot() +
labs(title = "Birth Weight Distribution by Gender",
x = "Gender (1=M)",
y = "Birth Weight (g)") +
theme_minimal()
# Perform normality test for each group (Shapiro-Wilk Test)
shapiro.test(Births$`BIRTH WEIGHT`[Births$`GENDER (1=M)` == "0"])
shapiro.test(Births$`BIRTH WEIGHT`[Births$`GENDER (1=M)` == "1"])
# Since the data may not be normally distributed, use the Mann-Whitney U test
wilcox.test(`BIRTH WEIGHT` ~ `GENDER (1=M)`, data = Births, alternative = "two.sided")
# Display summary statistics
Births %>%
group_by(`GENDER (1=M)`) %>%
summarise(median_bw = median(`BIRTH WEIGHT`),
mean_bw = mean(`BIRTH WEIGHT`),
sd_bw = sd(`BIRTH WEIGHT`))
library(readxl)
IQ_Brain_Size <- read_excel("IQ_Brain_Size.xlsx")
data <- IQ_Brain_Size
library(ggplot2)
# Assumption check: Scatter plot
ggplot(data, aes(x = IQ, y = VOL)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(title = "Scatterplot of IQ vs Brain Volume", x = "IQ", y = "Brain Volume (VOL)")
# Pearson correlation test
cor_test <- cor.test(data$IQ, data$VOL)
# Output correlation coefficient and p-value
cor_test
# Plot residuals for assumption check
model <- lm(VOL ~ IQ, data = data)
ggplot(data, aes(x = IQ, y = model$residuals)) +
geom_point() +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(title = "Residual Plot", x = "IQ", y = "Residuals")
# Summary of the linear regression model (optional)
summary(model)
# Original data
set.seed(123)
steps <- c(3200, 2900, 3100, 3000, 2800, 3500, 3100, 3000, 3300, 3400,
2800, 2900, 3200, 3000, 3100, 3300, 3400, 3600, 3500, 3400,
3000, 2900, 3100, 3200, 3100, 3000, 2800, 2900, 3200, 3100,
3000, 3200, 3300, 3400, 3500, 3600, 3400, 3300, 3200, 3100)
## Q.5.1
# Plotting histogram of original data
hist(steps, prob = TRUE, main = "Histogram of Original Step Data with Normal Density Curve", xlab = "Steps")
curve(dnorm(x, mean = mean(steps), sd = sd(steps)), add = TRUE, col = "blue", lwd = 2)
## Q.5.2
# Log transformation
log_steps <- log(steps)
# Plotting histogram of log-transformed data
hist(log_steps, prob = TRUE, main = "Histogram of Log-Transformed Step Data with Normal Density Curve", xlab = "Log(Steps)")
curve(dnorm(x, mean = mean(log_steps), sd = sd(log_steps)), add = TRUE, col = "blue", lwd = 2)
## Q.5.3
# Shapiro-Wilk test for original data
shapiro_original <- shapiro.test(steps)
# Shapiro-Wilk test for log-transformed data
shapiro_log <- shapiro.test(log_steps)
# Display results
shapiro_original
shapiro_log
library(readxl)
arsenic_data <- read_excel("Arsenic.xlsx")
# Convert STATE to a factor
arsenic_data$STATE <- as.factor(arsenic_data$STATE)
# Check the structure of the data
str(arsenic_data)
# 2. Assumption Checks
# Check for homogeneity of variances using Levene's Test
leveneTest(ARSENIC ~ STATE, data = arsenic_data)
# Check for normality using QQ plots and Shapiro-Wilk test for each group
par(mfrow = c(1, 3))  # Set up a 1x3 plotting area
with(arsenic_data, {
qqnorm(ARSENIC[STATE == "Arkansas"], main = "Arkansas")
qqline(ARSENIC[STATE == "Arkansas"])
qqnorm(ARSENIC[STATE == "California"], main = "California")
qqline(ARSENIC[STATE == "California"])
qqnorm(ARSENIC[STATE == "Texas"], main = "Texas")
qqline(ARSENIC[STATE == "Texas"])
})
shapiro.test(arsenic_data$ARSENIC[arsenic_data$STATE == "Arkansas"])
shapiro.test(arsenic_data$ARSENIC[arsenic_data$STATE == "California"])
shapiro.test(arsenic_data$ARSENIC[arsenic_data$STATE == "Texas"])
# 3. Perform the one-way ANOVA
anova_model <- aov(ARSENIC ~ STATE, data = arsenic_data)
# Get the summary of the ANOVA (provides MS Between, MS Within, and F value)
summary(anova_model)
# 6. Interpretation of the p-value
p_value <- summary(anova_model)[[1]]["Pr(>F)"][1]
# 7. Conclusion based on the p-value
if (p_value < 0.05) {
cat("Reject Ho: The mean arsenic levels differ between states.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
cat("Fail to reject Ho: There is no significant difference in arsenic levels between states.\n")
}
# Get the summary of the ANOVA (provides MS Between, MS Within, and F value)
summary(anova_model)
cat("3. Mean Squared Between (MS Between) = 15.83")
cat("4. Mean Squared Between (Ms Within) = 0.69")
cat("5. F-Value = 22.95")
# 6. Interpretation of the p-value
p_value <- summary(anova_model)[[1]]["Pr(>F)"][1]
# 7. Conclusion based on the p-value
if (p_value < 0.05) {
cat("Reject Ho: The mean arsenic levels differ between states.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
cat("Fail to reject Ho: There is no significant difference in arsenic levels between states.\n")
}
View(p_value)
# Get the summary of the ANOVA (provides MS Between, MS Within, and F value)
summary(anova_model)
# 6. Interpretation of the p-value
p_value <- summary(anova_model)[[1]]["Pr(>F)"][1]
View(p_value)
# 6. Interpretation of the p-value
p_value <- .000000568
# 7. Conclusion based on the p-value
if (p_value < 0.05) {
cat("Reject Ho: The mean arsenic levels differ between states.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
cat("Fail to reject Ho: There is no significant difference in arsenic levels between states.\n")
}
# 7. Conclusion based on the p-value
cat("Reject Ho: The mean arsenic levels differ between states.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
} else {
# 7. Conclusion based on the p-value
cat("Reject Ho: The mean arsenic levels differ between states since the p-value < 0.005.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
# 6. Interpretation of the p-value
p_value <- .000000568
# 7. Conclusion based on the p-value
cat("Reject Ho: The mean arsenic levels differ between states since the p-value < 0.005.\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
# 7. Conclusion based on the p-value
cat("Reject Ho: The mean arsenic levels differ between states since the p-value < 0.005.\n")
# 7. Conclusion based on the p-value
cat("Reject Ho: The mean arsenic levels differ between states since the p-value < 0.005\n")
# 8. Post-hoc test (Tukey's HSD)
tukey_test <- TukeyHSD(anova_model)
print(tukey_test)
